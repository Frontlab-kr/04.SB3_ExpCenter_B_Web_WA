import{_}from"./M4_Input-C0pluhh3.js";import{_ as V,E as n,A as C,g as S,i as A,l as a,s,I as p,k as t,G as g,D as u,H as f,x as c,y as D,V as b,a0 as x,a1 as y}from"./index-DReF1MdF.js";import{V as I,a as k}from"./VRow-X-t7FfBP.js";import{V as w}from"./VCheckbox-DEa3Negi.js";const B={data(){return{bDialog:!1,formData:{receiverHP:"",receiverName:"",receiverBirthday:""},receiptId:"",isAgree:!1,bAgreeDialog:!1,bSuccessDialog:!1,authState:-1,token:""}},mounted(){},watch:{},beforeDestroy(){},methods:{DialogClose(){this.bDialog=!1,this.$store.state.isDialog=!1,n.$emit("onBackDialogBtn")},ShowDialog(){this.InitData(),this.bDialog=!0},InitData(){this.formData.receiverHP="",this.formData.receiverName="",this.formData.receiverBirthday="",this.receiptId="",this.authState=-1,this.statusCheckInterval=null,this.token=""},DialogClose2(){this.bAgreeDialog=!1,this.$store.state.isDialog=!1,n.$emit("onBackDialogBtn")},DialogClose3(){this.bSuccessDialog=!1,this.$store.state.isDialog=!1,n.$emit("onBackDialogBtn")},openAgreeForm(){this.bAgreeDialog=!0,this.$store.state.isDialog=!0,this.$store.state.btnDialogRef=document.activeElement},changeAgree(){this.isAgree=!this.isAgree},clickAgree(){this.isAgree=!0,this.DialogClose2()},KakaoAuthCheck(){var l=!1,e="";if(!l&&this.formData.receiverName==""&&(l=!0,e="이름을 입력하십시오."),!l&&this.formData.receiverBirthday==""&&(l=!0,e="생년월일을 입력하십시오."),!l&&!this.validateBirthdate(this.formData.receiverBirthday)&&(l=!0,e="유효하지 않은 생년월일입니다."),!l&&this.formData.receiverHP==""&&(l=!0,e="휴대번호를 입력하십시오."),!l&&!this.validatePhoneNumber(this.formData.receiverHP)&&(l=!0,e="유효하지 않은 휴대폰 번호입니다."),!l&&!this.isAgree&&(l=!0,e="개인정보 제공동의를 클릭하십시오."),l){n.$emit("onShowMsg",{cSubTitle:"누락된 정보가 있습니다.",cTitle:e,cMsg:""});return}var h={receiverName:this.formData.receiverName,receiverHP:this.formData.receiverHP,receiverBirthday:this.formData.receiverBirthday};C.post("https://test1-fire.seoul.go.kr/cmsapi/KakaoAuthCheck",h,{headers:{}}).then(d=>{d.data.ResultCd==="00"?(this.receiptId=d.data.Result[0].receiptId,this.token=d.data.Result[0].jwt,console.log(">>>>>>>>>>> receiptId::",this.receiptId),console.log(">>>>>>>>>>> token::",this.token),this.DialogClose2(),this.bSuccessDialog=!0,this.$store.state.isDialog=!0,this.$store.state.btnDialogRef=document.activeElement):(n.$emit("onShowMsg",{cSubTitle:"카카오 본인인증에 실패하였습니다.",cTitle:"다시 시도해 주세요. 계속 지속될 경우 담당자에게 문의 바랍니다.",cMsg:""}),this.InitData())}).catch(d=>{n.$emit("onShowMsg",{cSubTitle:"카카오 본인인증 중에 문제가 발생했습니다.",cTitle:"다시 시도해 주세요. 계속 지속될 경우 담당자에게 문의 바랍니다.",cMsg:""}),this.InitData()}).finally(()=>{this.DialogClose()})},KakaoAuthCheckStatus(){var l={receiverName:this.formData.receiverName,receiverHP:this.formData.receiverHP,receiverBirthday:this.formData.receiverBirthday,receiptId:this.receiptId,token:this.token};console.log(">>>>>>>>>>>",l),C.post("https://test1-fire.seoul.go.kr/cmsapi/KakaoAuthCheckStatus",l,{headers:{}}).then(e=>{e.data.ResultCd==="00"?(this.authState=e.data.Result[0].State,console.log(">>>>>>>>>>> authState::",this.authState),this.authState===1?(console.log("인증이 완료되었습니다.",this.formData.receiverName,this.formData.receiverHP,this.formData.receiverBirthday,this.token),this.$emit("SuccessKakaoAuth",{name:this.formData.receiverName,phone:this.formData.receiverHP,birth:this.formData.receiverBirthday,jwt:this.token}),this.DialogClose3(),this.InitData()):this.authState===0?(console.log("인증이 완료되지 않았습니다."),n.$emit("onShowMsg",{cSubTitle:"본인인증이 완료되지 않았습니다.",cTitle:"휴대폰에서 카카오 본인인증을 먼저 진행해주세요.",cMsg:""})):this.authState===2&&(console.log("인증이 만료되었습니다."),n.$emit("onShowMsg",{cSubTitle:"본인인증이 요청기한이 만료되었습니다.",cTitle:"다시 시도해 주세요.",cMsg:""}),this.DialogClose3(),this.InitData())):(console.error("본인인증 상태 확인 실패:",e.data.ResultCd),n.$emit("onShowMsg",{cSubTitle:"카카오 본인인증 중에 문제가 발생했습니다.",cTitle:"다시 시도해 주세요. 계속 지속될 경우 담당자에게 문의 바랍니다.",cMsg:""}),this.DialogClose3(),this.InitData())}).catch(e=>{n.$emit("onShowMsg",{cSubTitle:"카카오 본인인증 중에 문제가 발생했습니다.",cTitle:"다시 시도해 주세요. 계속 지속될 경우 담당자에게 문의 바랍니다.",cMsg:""}),this.DialogClose3(),this.InitData()}).finally(()=>{})},validateBirthdate(l){if(!/^\d{8}$/.test(l))return!1;const h=parseInt(l.substring(0,4),10),d=parseInt(l.substring(4,6),10),r=parseInt(l.substring(6,8),10),o=new Date(h,d-1,r);return o.getFullYear()===h&&o.getMonth()===d-1&&o.getDate()===r},validatePhoneNumber(l){return/^01[0|1|6|7|8|9]-?\d{3,4}-?\d{4}$/.test(l)}}},m=l=>(x("data-v-bd93a4e7"),l=l(),y(),l),M={class:"d-flex"},N=m(()=>t("div",{class:"title-large"},"KAKAO 본인인증",-1)),K={style:{"max-height":"80vh",overflow:"hidden"}},T={class:"agreement"},P={class:"d-flex flex-wrap justify-center mt-4"},H={class:"d-flex"},U=m(()=>t("div",{class:"title-large"},"개인정보 제3자 제공",-1)),R=m(()=>t("div",{class:"bg-body"},[t("p",null," 소방재난본부는 개인정보 제3자 제공에 있어 아래 사항을 정보주체에게 안내합니다. "),t("br"),t("ul",{class:"ml-5"},[t("li",null,[t("strong",null,"개인정보 수집 및 이용목적"),t("ul",null,[t("li",null,"카카오 인증")])]),t("li",null,[t("strong",null,"제공하는 개인정보 항목"),t("ul",null,[t("li",null,"[필수] 이름, 생년월일, 휴대폰번호")])]),t("li",null,[t("strong",null,"개인정보 보유 및 이용기간"),t("ul",null,[t("li",null,"인증 완료 후 즉시 파기")])])]),t("br"),t("p",null," 귀하는 동의를 거부하실 수 있으나, 이 경우 인증을 받으실 수 없습니다. ")],-1)),E={class:"d-flex flex-wrap justify-center mt-4"},F={class:"win-box"},j={class:"d-flex title-small font-bold"},$=m(()=>t("div",null,"인증 요청이 완료되었습니다.",-1)),G=m(()=>t("div",{class:"title-medium font-bold mt-2"},"휴대폰에서 카카오 인증을 진행해주세요.",-1)),O=m(()=>t("div",{class:"mt-3"},"인증완료 후, 확인 버튼을 클릭해 주세요.",-1)),Y={class:"mt-3 d-flex"};function q(l,e,h,d,r,o){const v=_;return S(),A("div",null,[a(b,{"aria-modal":"true","onUpdate:modelValue":[o.DialogClose,e[9]||(e[9]=i=>r.bDialog=i)],modelValue:r.bDialog,width:"350px"},{default:s(()=>[a(p,{class:"pa-4 pl-6 pr-6"},{default:s(()=>[t("div",M,[N,a(g),a(u,{variant:"plain",class:"mt-n3 mr-n3",icon:"",onClick:o.DialogClose,title:"닫기"},{default:s(()=>[a(f,{"aria-hidden":"true"},{default:s(()=>[c("mdi-close")]),_:1})]),_:1},8,["onClick"])]),t("div",K,[a(I,{class:"ma-0"},{default:s(()=>[a(k,{cols:"12",md:"12",sm:"12",class:"mb-n3"},{default:s(()=>[a(v,{modelValue:r.formData.receiverName,"onUpdate:modelValue":e[0]||(e[0]=i=>r.formData.receiverName=i),label:"이름"},null,8,["modelValue"])]),_:1}),a(k,{cols:"12",md:"12",sm:"12",class:"mb-n3"},{default:s(()=>[a(v,{modelValue:r.formData.receiverBirthday,"onUpdate:modelValue":e[1]||(e[1]=i=>r.formData.receiverBirthday=i),label:"생년월일 8자리 숫자로 입력 (예: 20250212)"},null,8,["modelValue"])]),_:1}),a(k,{cols:"12",md:"12",sm:"12",class:"mb-n3"},{default:s(()=>[a(v,{modelValue:r.formData.receiverHP,"onUpdate:modelValue":e[2]||(e[2]=i=>r.formData.receiverHP=i),label:"휴대폰번호 (숫자만 입력, '-'제외)"},null,8,["modelValue"])]),_:1}),t("div",T,[a(w,{modelValue:r.isAgree,"onUpdate:modelValue":e[3]||(e[3]=i=>r.isAgree=i),label:"개인정보 제3자 제공에 동의합니다.","aria-label":"개인정보 제3자 제공 동의",class:"checkbox","hide-details":"",onKeyup:e[4]||(e[4]=D(i=>o.changeAgree(),["enter"]))},null,8,["modelValue"])]),t("div",{class:"details-link",onClick:e[5]||(e[5]=i=>o.openAgreeForm()),onKeyup:e[6]||(e[6]=D(i=>o.openAgreeForm(),["enter"])),tabindex:"0",role:"button"}," 내용보기 >",32)]),_:1})]),t("div",P,[a(u,{onClick:e[7]||(e[7]=i=>o.KakaoAuthCheck()),onKeyup:e[8]||(e[8]=D(i=>o.KakaoAuthCheck(),["enter"])),class:"mb-1",color:"black",width:"150"},{default:s(()=>[c("본인인증 요청"),a(f,{"aria-hidden":"true",class:"ml-1"},{default:s(()=>[c("mdi-upload")]),_:1})]),_:1})])]),_:1})]),_:1},8,["onUpdate:modelValue","modelValue"]),a(b,{"aria-modal":"true","onUpdate:modelValue":[o.DialogClose2,e[12]||(e[12]=i=>r.bAgreeDialog=i)],modelValue:r.bAgreeDialog,width:"450px"},{default:s(()=>[a(p,{class:"pa-4 pl-6 pr-6"},{default:s(()=>[t("div",H,[U,a(g),a(u,{variant:"plain",class:"mt-n3 mr-n3",icon:"",onClick:o.DialogClose2,title:"닫기"},{default:s(()=>[a(f,{"aria-hidden":"true"},{default:s(()=>[c("mdi-close")]),_:1})]),_:1},8,["onClick"])]),R,t("div",E,[a(u,{onClick:e[10]||(e[10]=i=>o.clickAgree()),onKeyup:e[11]||(e[11]=D(i=>o.clickAgree(),["enter"])),class:"mb-1",color:"black",width:"150"},{default:s(()=>[c("동의하기"),a(f,{"aria-hidden":"true",class:"ml-1"},{default:s(()=>[c("mdi-upload")]),_:1})]),_:1})])]),_:1})]),_:1},8,["onUpdate:modelValue","modelValue"]),a(b,{"aria-modal":"true","onUpdate:modelValue":[o.DialogClose3,e[14]||(e[14]=i=>r.bSuccessDialog=i)],modelValue:r.bSuccessDialog,width:"560px"},{default:s(()=>[a(p,{class:"pa-4 pl-6 pr-6"},{default:s(()=>[t("div",F,[t("div",j,[$,a(g),a(u,{class:"mt-n5 mr-n5",icon:"mdi-close",variant:"plain",onClick:o.DialogClose3,color:"black",title:"닫기"},null,8,["onClick"])]),G,O,t("div",Y,[a(g),a(u,{variant:"outlined",color:"black",onClick:o.DialogClose3},{default:s(()=>[c("취소")]),_:1},8,["onClick"]),a(u,{class:"ml-2",color:"primary",onClick:e[13]||(e[13]=i=>o.KakaoAuthCheckStatus())},{default:s(()=>[c("확인")]),_:1})])])]),_:1})]),_:1},8,["onUpdate:modelValue","modelValue"])])}const W=V(B,[["render",q],["__scopeId","data-v-bd93a4e7"]]);export{W as A};
