import{_ as V}from"./M4_Input-DY6Ewlnh.js";import{_,E as n,A as C,f as y,g as S,k as a,q as l,H as p,j as t,D as f,C as u,G as g,t as d,y as D,V as b,$ as A,a0 as I}from"./index-DIDkCmdu.js";import{V as w,a as k}from"./VRow-B16yWfRQ.js";import{V as x}from"./VCheckbox-CjfxHLU8.js";const B={data(){return{bDialog:!1,formData:{receiverHP:"01022550787",receiverName:"김형준",receiverBirthDay:"19980810"},receiptId:"",isAgree:!1,bAgreeDialog:!1,bSuccessDialog:!1,authState:-1,token:""}},mounted(){},watch:{},beforeDestroy(){},methods:{DialogClose(){this.bDialog=!1,this.$store.state.isDialog=!1,n.$emit("onBackDialogBtn")},DialogClose2(){this.bAgreeDialog=!1,this.$store.state.isDialog=!1,n.$emit("onBackDialogBtn")},DialogClose3(){this.bSuccessDialog=!1,this.$store.state.isDialog=!1,n.$emit("onBackDialogBtn")},ShowDialog(){this.InitData(),this.bDialog=!0,this.$store.state.isDialog=!0,this.$store.state.btnDialogRef=document.activeElement},InitData(){this.formData.receiverHP="",this.formData.receiverName="",this.formData.receiverBirthDay="",this.receiptId="",this.authState=-1,this.statusCheckInterval=null,this.token=""},openAgreeForm(){this.bAgreeDialog=!0,this.$store.state.isDialog=!0,this.$store.state.btnDialogRef=document.activeElement},changeAgree(){this.isAgree=!this.isAgree},clickAgree(){this.isAgree=!0,this.DialogClose2()},KakaoAuthCheck(){var i=!1,e="";if(!i&&this.formData.receiverName==""&&(i=!0,e="이름을 입력하십시오."),!i&&this.formData.receiverBirthDay==""&&(i=!0,e="생년월일을 입력하십시오."),!i&&!this.validateBirthdate(this.formData.receiverBirthDay)&&(i=!0,e="유효하지 않은 생년월일입니다."),!i&&this.formData.receiverHP==""&&(i=!0,e="휴대번호를 입력하십시오."),!i&&!this.validatePhoneNumber(this.formData.receiverHP)&&(i=!0,e="유효하지 않은 휴대폰 번호입니다."),!i&&!this.isAgree&&(i=!0,e="개인정보 제공동의를 클릭하십시오."),i){n.$emit("onShowMsg",{cSubTitle:"누락된 정보가 있습니다.",cTitle:e,cMsg:""});return}var h={receiverName:this.formData.receiverName,receiverHP:this.formData.receiverHP,receiverBirthDay:this.formData.receiverBirthDay};C.post("https://test1-fire.seoul.go.kr/cmsapi/KakaoAuthCheck",h,{headers:{}}).then(c=>{c.data.ResultCd==="00"?(this.receiptId=c.data.Result[0].receiptId,this.token=c.data.Result[0].jwt,console.log(">>>>>>>>>>> receiptId::",this.receiptId),console.log(">>>>>>>>>>> token::",this.token),this.DialogClose2(),this.bSuccessDialog=!0,this.$store.state.isDialog=!0,this.$store.state.btnDialogRef=document.activeElement):(n.$emit("onShowMsg",{cSubTitle:"카카오 본인인증에 실패하였습니다.",cTitle:"다시 시도해 주세요. 계속 지속될 경우 담당자에게 문의 바랍니다.",cMsg:""}),this.InitData())}).catch(c=>{n.$emit("onShowMsg",{cSubTitle:"카카오 본인인증 중에 문제가 발생했습니다.",cTitle:"다시 시도해 주세요. 계속 지속될 경우 담당자에게 문의 바랍니다.",cMsg:""}),this.InitData()}).finally(()=>{this.DialogClose()})},KakaoAuthCheckStatus(){var i={receiverName:this.formData.receiverName,receiverHP:this.formData.receiverHP,receiverBirthDay:this.formData.receiverBirthDay,receiptId:this.receiptId,token:this.token};console.log(">>>>>>>>>>>",i),C.post("https://test1-fire.seoul.go.kr/cmsapi/KakaoAuthCheckStatus",i,{headers:{}}).then(e=>{e.data.ResultCd==="00"?(this.authState=e.data.Result[0].State,console.log(">>>>>>>>>>> authState::",this.authState),this.authState===1?(console.log("인증이 완료되었습니다.",this.formData.receiverName,this.formData.receiverHP,this.formData.receiverBirthDay,this.token),this.$emit("SuccessKakaoAuth",{name:this.formData.receiverName,phone:this.formData.receiverHP,birth:this.formData.receiverBirthDay,jwt:this.token}),this.DialogClose3(),this.InitData()):this.authState===0?(console.log("인증이 완료되지 않았습니다."),n.$emit("onShowMsg",{cSubTitle:"본인인증이 완료되지 않았습니다.",cTitle:"휴대폰에서 카카오 본인인증을 먼저 진행해주세요.",cMsg:""})):this.authState===2&&(console.log("인증이 만료되었습니다."),n.$emit("onShowMsg",{cSubTitle:"본인인증이 요청기한이 만료되었습니다.",cTitle:"다시 시도해 주세요.",cMsg:""}),this.DialogClose3(),this.InitData())):(console.error("본인인증 상태 확인 실패:",e.data.ResultCd),n.$emit("onShowMsg",{cSubTitle:"카카오 본인인증 중에 문제가 발생했습니다.",cTitle:"다시 시도해 주세요. 계속 지속될 경우 담당자에게 문의 바랍니다.",cMsg:""}),this.DialogClose3(),this.InitData())}).catch(e=>{n.$emit("onShowMsg",{cSubTitle:"카카오 본인인증 중에 문제가 발생했습니다.",cTitle:"다시 시도해 주세요. 계속 지속될 경우 담당자에게 문의 바랍니다.",cMsg:""}),this.DialogClose3(),this.InitData()}).finally(()=>{})},validateBirthdate(i){if(!/^\d{8}$/.test(i))return!1;const h=parseInt(i.substring(0,4),10),c=parseInt(i.substring(4,6),10),r=parseInt(i.substring(6,8),10),s=new Date(h,c-1,r);return s.getFullYear()===h&&s.getMonth()===c-1&&s.getDate()===r},validatePhoneNumber(i){return/^01[0|1|6|7|8|9]-?\d{3,4}-?\d{4}$/.test(i)}}},m=i=>(A("data-v-16e9da75"),i=i(),I(),i),P={class:"d-flex"},N=m(()=>t("div",{class:"title-large"},"KAKAO Identity Verification",-1)),K={style:{"max-height":"80vh",overflow:"hidden"}},T={class:"agreement"},M={class:"d-flex flex-wrap justify-center mt-4"},H={class:"d-flex"},R=m(()=>t("div",{class:"title-large"},"Provision of Personal Information to Third Parties",-1)),U=m(()=>t("div",{class:"bg-body"},[t("p",null," The Fire and Disaster Headquarters provides the following information to the data subject regarding the provision of personal information to third parties. "),t("br"),t("ul",{class:"ml-5"},[t("li",null,[t("strong",null,"Purpose of Personal Information Collection and Use"),t("ul",null,[t("li",null,"Kakao Verification")])]),t("li",null,[t("strong",null,"Personal Information Provided"),t("ul",null,[t("li",null,"[Required] Name, Date of Birth, Phone Number")])]),t("li",null,[t("strong",null,"Retention and Usage Period of Personal Information"),t("ul",null,[t("li",null,"Immediately discarded after verification completion")])])]),t("br"),t("p",null," You may refuse to consent, but in this case, verification cannot be performed. ")],-1)),E={class:"d-flex flex-wrap justify-center mt-4"},j={class:"win-box"},F={class:"d-flex title-small font-bold"},$=m(()=>t("div",null,"Verification Request Completed",-1)),q=m(()=>t("div",{class:"title-medium font-bold mt-2"},"Please proceed with Kakao verification on your phone.",-1)),Y=m(()=>t("div",{class:"mt-3"},"After completion, click the Confirm button.",-1)),G={class:"mt-3 d-flex"};function O(i,e,h,c,r,s){const v=V;return y(),S("div",null,[a(b,{"aria-modal":"true","onUpdate:modelValue":[s.DialogClose,e[9]||(e[9]=o=>r.bDialog=o)],modelValue:r.bDialog,width:"350px"},{default:l(()=>[a(p,{class:"pa-4 pl-6 pr-6"},{default:l(()=>[t("div",P,[N,a(f),a(u,{variant:"plain",class:"mt-n3 mr-n3",icon:"",onClick:s.DialogClose,title:"close"},{default:l(()=>[a(g,{"aria-hidden":"true"},{default:l(()=>[d("mdi-close")]),_:1})]),_:1},8,["onClick"])]),t("div",K,[a(w,{class:"ma-0"},{default:l(()=>[a(k,{cols:"12",md:"12",sm:"12",class:"mb-n3"},{default:l(()=>[a(v,{modelValue:r.formData.receiverName,"onUpdate:modelValue":e[0]||(e[0]=o=>r.formData.receiverName=o),label:"Name"},null,8,["modelValue"])]),_:1}),a(k,{cols:"12",md:"12",sm:"12",class:"mb-n3"},{default:l(()=>[a(v,{modelValue:r.formData.receiverBirthDay,"onUpdate:modelValue":e[1]||(e[1]=o=>r.formData.receiverBirthDay=o),label:"Date of Birth (8 digits, yyyymmdd)"},null,8,["modelValue"])]),_:1}),a(k,{cols:"12",md:"12",sm:"12",class:"mb-n3"},{default:l(()=>[a(v,{modelValue:r.formData.receiverHP,"onUpdate:modelValue":e[2]||(e[2]=o=>r.formData.receiverHP=o),label:"Phone Number (Enter numbers only, excluding '-')"},null,8,["modelValue"])]),_:1}),t("div",T,[a(x,{modelValue:r.isAgree,"onUpdate:modelValue":e[3]||(e[3]=o=>r.isAgree=o),label:"I agree to the provision of personal information to third parties.",class:"checkbox","hide-details":"",onKeyup:e[4]||(e[4]=D(o=>s.changeAgree(),["enter"]))},null,8,["modelValue"])]),t("div",{class:"details-link",onClick:e[5]||(e[5]=o=>s.openAgreeForm()),onKeyup:e[6]||(e[6]=D(o=>s.openAgreeForm(),["enter"])),tabindex:"0",role:"button"}," View Details >",32)]),_:1})]),t("div",M,[a(u,{onClick:e[7]||(e[7]=o=>s.KakaoAuthCheck()),onKeyup:e[8]||(e[8]=D(o=>s.KakaoAuthCheck(),["enter"])),class:"mb-1",color:"black",width:"150"},{default:l(()=>[d("Request Verification"),a(g,{"aria-hidden":"true",class:"ml-1"},{default:l(()=>[d("mdi-upload")]),_:1})]),_:1})])]),_:1})]),_:1},8,["onUpdate:modelValue","modelValue"]),a(b,{"aria-modal":"true","onUpdate:modelValue":[s.DialogClose2,e[12]||(e[12]=o=>r.bAgreeDialog=o)],modelValue:r.bAgreeDialog,width:"450px"},{default:l(()=>[a(p,{class:"pa-4 pl-6 pr-6"},{default:l(()=>[t("div",H,[R,a(f),a(u,{variant:"plain",class:"mt-n3 mr-n3",icon:"",onClick:s.DialogClose2},{default:l(()=>[a(g,{"aria-hidden":"true"},{default:l(()=>[d("mdi-close")]),_:1})]),_:1},8,["onClick"])]),U,t("div",E,[a(u,{onClick:e[10]||(e[10]=o=>s.clickAgree()),onKeyup:e[11]||(e[11]=D(o=>s.clickAgree(),["enter"])),class:"mb-1",color:"black",width:"150"},{default:l(()=>[d("Agree"),a(g,{"aria-hidden":"true",class:"ml-1"},{default:l(()=>[d("mdi-upload")]),_:1})]),_:1})])]),_:1})]),_:1},8,["onUpdate:modelValue","modelValue"]),a(b,{"aria-modal":"true","onUpdate:modelValue":[s.DialogClose3,e[14]||(e[14]=o=>r.bSuccessDialog=o)],modelValue:r.bSuccessDialog,width:"560px"},{default:l(()=>[a(p,{class:"pa-4 pl-6 pr-6"},{default:l(()=>[t("div",j,[t("div",F,[$,a(f),a(u,{class:"mt-n5 mr-n5",icon:"mdi-close",variant:"plain",onClick:s.DialogClose3,color:"black",title:"close"},null,8,["onClick"])]),q,Y,t("div",G,[a(f),a(u,{variant:"outlined",color:"black",onClick:s.DialogClose3},{default:l(()=>[d("Cancel")]),_:1},8,["onClick"]),a(u,{class:"ml-2",color:"primary",onClick:e[13]||(e[13]=o=>s.KakaoAuthCheckStatus())},{default:l(()=>[d("Confirm")]),_:1})])])]),_:1})]),_:1},8,["onUpdate:modelValue","modelValue"])])}const W=_(B,[["render",O],["__scopeId","data-v-16e9da75"]]);export{W as A};
